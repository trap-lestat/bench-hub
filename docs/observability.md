# 观测与优化

## 1. 监控指标
- 应用：请求 QPS、延迟（P50/P95/P99）、错误率
- 系统：CPU、内存、磁盘、网络
- 数据库：连接数、慢查询、锁等待

## 2. 日志与追踪
- 统一请求日志与错误日志
- trace_id/request_id 贯穿调用链
- 关键路径打点（认证、DB 查询）

## 3. 告警规则
- 错误率 > 1% 持续 5 分钟
- P95 延迟 > 300ms 持续 5 分钟
- CPU 使用率 > 80% 持续 10 分钟

## 4. 性能优化流程
- 压测前建立基线
- 发现瓶颈（CPU/DB/IO）
- 优化与回归验证

## 5. 容量规划
- 峰值并发与 QPS 预估
- 资源使用趋势与扩容策略
